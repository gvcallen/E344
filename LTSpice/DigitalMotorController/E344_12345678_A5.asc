Version 4
SHEET 1 1824 2192
WIRE -1824 -976 -2208 -976
WIRE -2208 -912 -2208 -976
WIRE -2208 -736 -2208 -752
WIRE -2208 -640 -2208 -656
WIRE -1984 -544 -2048 -544
WIRE -1696 -544 -1904 -544
WIRE -2048 -528 -2048 -544
WIRE -752 -464 -752 -528
WIRE -576 -464 -752 -464
WIRE -416 -464 -448 -464
WIRE -272 -464 -336 -464
WIRE -1712 -384 -2048 -384
WIRE -960 -384 -992 -384
WIRE -912 -384 -960 -384
WIRE -800 -384 -832 -384
WIRE -448 -368 -448 -464
WIRE -368 -368 -448 -368
WIRE -960 -352 -960 -384
WIRE -272 -352 -272 -464
WIRE -272 -352 -304 -352
WIRE -128 -352 -272 -352
WIRE -752 -336 -752 -368
WIRE -640 -336 -752 -336
WIRE -544 -336 -560 -336
WIRE -368 -336 -544 -336
WIRE -752 -320 -752 -336
WIRE -544 -304 -544 -336
WIRE -448 -304 -448 -368
WIRE -2224 -224 -2272 -224
WIRE -960 -224 -960 -272
WIRE -752 -224 -752 -240
WIRE -752 -224 -960 -224
WIRE -752 -208 -752 -224
WIRE -544 -208 -544 -240
WIRE -448 -208 -448 -224
WIRE -448 -208 -544 -208
WIRE -336 -208 -336 -320
WIRE -336 -208 -448 -208
WIRE -336 -192 -336 -208
WIRE -2224 -176 -2224 -224
WIRE -2176 -176 -2224 -176
WIRE -2032 -176 -2096 -176
WIRE -1856 -176 -1952 -176
WIRE -1856 -160 -1856 -176
WIRE -1856 -64 -1856 -80
WIRE -1808 -64 -1856 -64
WIRE -2112 -16 -2224 -16
WIRE -1744 -16 -2032 -16
WIRE -2016 80 -2096 80
WIRE -1888 80 -2016 80
WIRE -1760 80 -1888 80
WIRE -1728 80 -1760 80
WIRE -2096 112 -2096 80
WIRE -2016 112 -2016 80
WIRE -1888 112 -1888 80
WIRE -1760 112 -1760 80
WIRE -2096 240 -2096 192
WIRE -2016 240 -2016 176
WIRE -2016 240 -2096 240
WIRE -1936 240 -2016 240
WIRE -1888 240 -1888 192
WIRE -1888 240 -1936 240
WIRE -1760 240 -1760 192
WIRE -1760 240 -1888 240
WIRE -1936 272 -1936 240
FLAG -1696 -544 5V
IOPIN -1696 -544 Out
FLAG -2048 -448 0
FLAG -2208 -640 0
FLAG -1824 -976 motor_control
IOPIN -1824 -976 In
FLAG -992 -384 motor_control
IOPIN -992 -384 In
FLAG -752 -528 motor_voltage
IOPIN -752 -528 In
FLAG -2048 -304 0
FLAG -1712 -384 Vbatt
IOPIN -1712 -384 Out
FLAG -1808 -64 motor_voltage
IOPIN -1808 -64 In
FLAG -2272 -224 Vbatt
IOPIN -2272 -224 Out
FLAG -1728 80 Omega
FLAG -1936 272 0
FLAG -576 -528 Vbatt
IOPIN -576 -528 Out
FLAG -1744 -16 R_MSense
IOPIN -1744 -16 In
FLAG -2224 -16 0
FLAG -128 -352 R_MSense
IOPIN -128 -352 In
FLAG -336 -384 5V
IOPIN -336 -384 In
FLAG -336 -192 0
FLAG -752 -208 0
SYMBOL voltage -2048 -544 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res -2000 -560 M90
WINDOW 0 -7 47 VBottom 2
WINDOW 3 29 54 VTop 2
SYMATTR InstName RSense5V
SYMATTR Value 1µ
SYMBOL diode -560 -464 R180
WINDOW 0 -59 30 Left 2
WINDOW 3 65 39 Left 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL voltage -2208 -928 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 51 60 Left 2
SYMATTR Value PULSE(0 3.3 20m 0 0 60m 60 1)
SYMATTR InstName V3
SYMBOL voltage -2048 -400 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 47 50 Left 2
SYMATTR InstName V5
SYMATTR Value 6.5
SYMBOL res -2048 -160 R270
WINDOW 3 0 56 VBottom 2
WINDOW 0 32 56 VTop 2
SYMATTR Value {R_motor}
SYMATTR InstName Rm
SYMBOL ind -2192 -160 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName Lm
SYMATTR Value {L_motor}
SYMBOL bv -1856 -176 R0
WINDOW 3 -42 -15 Left 2
WINDOW 0 44 46 Left 2
SYMATTR Value V=V(Omega)*K_emf
SYMATTR InstName B_EMF
SYMBOL bi -2096 192 R180
WINDOW 0 24 80 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName B5
SYMATTR Value I=k_t*I(B_EMF)
SYMBOL bi -1760 112 R0
WINDOW 3 -419 208 Left 2
SYMATTR Value I=sgn(V(Omega))*min(Tint,0.1*abs(v(Omega)))
SYMATTR InstName B6
SYMBOL cap -2032 112 R0
WINDOW 0 -58 -53 Left 2
WINDOW 3 26 0 Left 2
SYMATTR InstName C_J_intertia
SYMATTR Value {J}
SYMBOL res -1904 96 R0
WINDOW 0 22 -39 Left 2
WINDOW 3 26 100 Left 2
SYMATTR InstName R_B_friction
SYMATTR Value {1/B}
SYMBOL voltage -2208 -848 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 51 60 Left 2
SYMATTR Value PULSE(0 3.3 150m 10u 10u 0.5m 1m 50)
SYMATTR InstName V1
SYMBOL voltage -2208 -752 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 51 60 Left 2
SYMATTR Value PULSE(0 3.3 200m 10u 10u 0.1m 1m 50)
SYMATTR InstName V4
SYMBOL res -768 -336 R0
SYMATTR InstName R_sense
SYMATTR Value 0.01
SYMBOL res -2016 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_MSense
SYMATTR Value 100k
SYMBOL Opamps\\LTC6079 -336 -352 R0
SYMATTR InstName U1
SYMBOL nmos -800 -464 R0
WINDOW 3 97 30 Left 2
SYMATTR InstName M1
SYMATTR Value FQD13N06L
SYMBOL res -320 -480 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Rf
SYMATTR Value 100k
SYMBOL res -464 -320 R0
SYMATTR InstName Rg
SYMATTR Value 120
SYMBOL res -544 -352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Ri
SYMATTR Value 150k
SYMBOL cap -560 -304 R0
SYMATTR InstName Ci
SYMATTR Value 100n
SYMBOL res -816 -400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Ra
SYMATTR Value 330
SYMBOL res -944 -256 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName Rb
SYMATTR Value 100k
TEXT -2288 -1384 Left 2 ;Don't change these -- used for auto-assessments.\nYou may modify the input files (.txt and .csv) \n               while developing.\nFor submission: \n  * Only one label name per net name\n  * Use only VSupply for power
TEXT -1552 -1400 Left 2 ;=============================\nREPLACE WITH YOUR DETAILS\nE. Stewdent.,  00024601\n=============================
TEXT -960 -1400 Left 2 ;=============================\nIncludes (don't fiddle with this!!)\n=============================
TEXT -1152 -1208 Left 2 ;=======================================\nYour circuit goes here, these are just placeholders.\n=======================================
TEXT -1392 -1448 Left 2 ;PLEASE WAIT FOR YOUR SIMULATION TO FINISH BEFORE SUBMITTING.
TEXT -2264 -1152 Left 2 !.tran 0 {transtop} 0 1u
TEXT -2264 -1184 Left 2 !.include A5cfg.txt
TEXT -2264 -1048 Left 2 ;Motor control\n(input to your circuit)
TEXT -2336 -520 Left 2 ;5V supply \n(input to your circuit)
TEXT -2336 -384 Left 2 ;Battery supply \n(input to your circuit)
TEXT -1936 -288 Left 2 ;Motor voltage\n(Output from your circuit)
TEXT -1032 -1112 Left 2 !.incl IRF9Z24N.LIB\n.incl FQD13N06L.LIB
LINE Normal -1584 -1424 -1584 368 2
LINE Normal -2368 -1424 -1584 -1424 2
LINE Normal -1584 368 -2368 368 2
LINE Normal -2368 -1424 -2368 368 2
